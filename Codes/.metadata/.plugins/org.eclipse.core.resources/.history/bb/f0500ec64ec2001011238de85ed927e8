
/*
 * STM32_GPT.c
 *
 *  Created on: Oct 19, 2025
 *      Author: ANAS
 */


#include <STM32_GPT.h>
#include <stdint.h>


void timer2_init(void)
{
	gpt2_ptr->TIMx_CR1 |= ENABLE_ARR_BUFFER;						/// Enabling ARR buffering ( will not update all of a sudden )
	gpt2_ptr->TIMx_DIER |= ENABLE_UPDATE_INTERRUPT;					/// Enabling the update interrupt
}

void timer2_set(uint32_t arr , uint32_t psc)
{
	gpt2_ptr->TIMx_ARR = arr;										/// Setting auto reload register value
	gpt2_ptr->TIMx_PSC = psc;										/// Setting prescalar value
	gpt2_ptr->TIMx_EGR |= 1;          								/// <<< Generate update event (IMPORTANT)
	gpt2_ptr->TIMx_CR1 |= TIMER_ON;									/// Turning on the timer (counter enabled)
}


